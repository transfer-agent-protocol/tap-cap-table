import { Steps, Callout } from 'nextra/components';
import Image from 'next/image';

# Deploy the Factory Contract

The factory contract deploys new cap tables and manages their addresses. It uses a beacon proxy pattern so all cap tables can be upgraded together.

<Steps>

### Run the deployment script

With Anvil running in another terminal:

```bash
pnpm run deploy-factory
```

### Note the contract addresses

The script outputs two addresses you'll need:

```bash
========================================
ðŸŽ‰ Deployment Complete!
========================================
CapTable (implementation): <YOUR_IMPLEMENTATION_ADDRESS>
CapTableFactory:           <YOUR_FACTORY_ADDRESS>
========================================
```

<Callout type="warning">
These addresses are unique to your deployment. They're derived from your wallet address and transaction nonce, so every developer and issuer will see different values.
</Callout>

### Add factory to MongoDB

Open MongoDB Compass and connect using:
```
mongodb://tap:tap@localhost:27017
```

Navigate to the `mongo` database, find (or create) the `factories` collection, and insert a new document using **your** addresses from the deployment output:

```json
{
  "implementation_address": "<YOUR_IMPLEMENTATION_ADDRESS>",
  "factory_address": "<YOUR_FACTORY_ADDRESS>"
}
```

![Factories](../../../public/images/mongo-factories.png)

</Steps>

Next, [start the server](/development/run-server) to begin using the API.
