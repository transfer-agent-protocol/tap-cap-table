import { Steps, Callout } from 'nextra/components';
import Image from 'next/image';

# Deploy the Factory Contract

The factory contract deploys new cap tables and manages their addresses. It uses a beacon proxy pattern so all cap tables can be upgraded together.

<Steps>

### Run the deployment script

With Anvil running in another terminal:

```bash
pnpm run deploy-factory
```

### Note the contract addresses

The script outputs two addresses you'll need:

```bash
== Logs ==
  Upgrading CapTableFactory with CapTable implementation
  Deploying CapTableFactory and CapTable implementation
  CapTable implementation deployed at: 0x5FbDB2315678afecb367f032d93F642f64180aa3
  CapTableFactory deployed at: 0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512
```

### Add factory to MongoDB

Open MongoDB Compass and connect using:
```
mongodb://tap:tap@localhost:27017
```

Navigate to the `mongo` database, find (or create) the `factories` collection, and insert a new document:

```json
{
  "implementation_address": "0x5FbDB2315678afecb367f032d93F642f64180aa3",
  "factory_address": "0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512"
}
```

<Callout type="info">
Use the addresses from your deployment output - they'll be different each time.
</Callout>

![Factories](../../../public/images/mongo-factories.png)

</Steps>

Next, [start the server](/development/run-server) to begin using the API.
